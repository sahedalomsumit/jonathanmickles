(()=>{function t(){var t=window.location.search.substring(1).split("&"),e={};return t.map((function(t){var o=t.split("=");e[o[0]]=o[1]})),e}window.crmcoFiredFbEvent=[];var e=function(t){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[-.+*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},o=function(t){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(t).replace(/[-.+*]/g,"\\$&")+"\\s*\\=").test(document.cookie)};function n(){var n=t();try{var a,c,i=null===(a=localStorage)||void 0===a?void 0:a.getItem("_fbc");if(n.fbclid&&n.fbclid.length>0)if(i=n.fbclid)null===(c=localStorage)||void 0===c||c.setItem("_fbc",i)}catch(t){}try{var l;if(o("_fbc"))fbc=e("_fbc"),null===(l=localStorage)||void 0===l||l.setItem("_fbc",fbc)}catch(t){}try{var r,f,d=null===(r=localStorage)||void 0===r?void 0:r.getItem("_fbp");if(n.fbp&&n.fbp.length>0)if(d=n.fbp)null===(f=localStorage)||void 0===f||f.setItem("_fbp",d)}catch(t){}try{var v;if(o("_fbp"))fbp=e("_fbp"),null===(v=localStorage)||void 0===v||v.setItem("_fbp",fbp)}catch(t){}try{var u;if(!fbp||"string"!=typeof fbp||0==fbp.length)fbp=(console.log("generateFbp"),"fb.1.".concat(Date.now(),".").concat(function(t){for(var e="0123456789",o="",n=10;n>0;--n)o+=e[Math.floor(Math.random()*e.length)];return o}())),null===(u=localStorage)||void 0===u||u.setItem("_fbp",fbp)}catch(t){}var s={page_id:window.crmcoPage,page_url:window.location.href,fbc};fbp&&(s.fbp=fbp),window.fbEventId&&(s.fb_event_id=window.fbEventId);try{var m,b=null===(m=localStorage)||void 0===m?void 0:m.getItem("contact_id");b&&(s.contact_id=b)}catch(t){}try{var _,g=null===(_=localStorage)||void 0===_?void 0:_.getItem("contact_token");g&&(s.cid_token=g)}catch(t){}return s}window.addEventListener("load",(function(){var e=t(),o=[];try{var n,a,c,i,l,r,f,d;if(e.iid)null===(n=localStorage)||void 0===n||n.setItem("new_iid",e.iid);if(e.utm_content)null===(a=localStorage)||void 0===a||a.setItem("utm_content",e.utm_content);if(e.utm_medium)null===(c=localStorage)||void 0===c||c.setItem("utm_medium",e.utm_medium);if(e.utm_source)null===(i=localStorage)||void 0===i||i.setItem("utm_source",e.utm_source);if(e.utm_campaign)null===(l=localStorage)||void 0===l||l.setItem("utm_campaign",e.utm_campaign);if(e.clid)null===(r=localStorage)||void 0===r||r.setItem("clid",e.clid);if(e.form_session_id)null===(f=localStorage)||void 0===f||f.setItem("form_session_id",e.form_session_id);if(e.post_message_domain)null===(d=localStorage)||void 0===d||d.setItem("post_message_domain",e.post_message_domain);e.contact_id,e.cid_token}catch(t){}for(var v in e)e[v]&&"function"!=typeof e[v]&&o.push("".concat(v,"=").concat(e[v]));if(o.length>0){var u=o.join("&");document.querySelectorAll("a").forEach((function(t){t.onclick=function(e){var o=t.getAttribute("href");o&&!o.includes("#")&&(-1!=o.lastIndexOf("?")?o+="&".concat(u):o+="?".concat(u),t.setAttribute("href",o))}}))}}));var a=function(t){var e=n(),o=Object.assign(e,t);fetch("/api/utility/facebookConversionEvent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(t){return t.json()})).then((function(t){var e,o,n;if(console.log("fireFacebookConversionEvent response",t),t.fbp)try{var a;null===(a=localStorage)||void 0===a||a.setItem("_fbp",t.fbp)}catch(t){}if(null!=t&&null!==(e=t.data)&&void 0!==e&&e.fbp)try{var c;null===(c=localStorage)||void 0===c||c.setItem("_fbp",t.data.fbp)}catch(t){}if(null!=t&&null!==(o=t.data)&&void 0!==o&&o.fbc)try{var i;null===(i=localStorage)||void 0===i||i.setItem("_fbc",t.data.fbc)}catch(t){}if(null!=t&&null!==(n=t.data)&&void 0!==n&&n.contact_id)try{var l;null===(l=localStorage)||void 0===l||l.setItem("contact_id",t.data.contact_id)}catch(t){}})).catch((function(t){}))};window.fireFacebookConversionEvent=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(window.enableFbTrack&&t&&t.length>0)for(var o=0;o<t.length;o++){var n=t[o];if(e){var c="".concat(window.crmcoPage,"-").concat(n.event_id);window.crmcoFiredFbEvent.includes(c)||(window.fbq&&window.fbq("track",n.event_name,{},{eventID:window.fbEventId}),window.crmcoFiredFbEvent.push(c),a({event_id:n.event_id}))}else a({event_id:n.event_id})}},window.fireFacebookFormEvent=function(t){if(window.enableFbTrack){console.log("fireFacebookFormEvent 1",t);n();for(var e=0;e<t.length;e++){var o=t[e];fetch("/api/form/loadFormData/".concat(o),{method:"GET"}).then((function(t){return t.json()})).then((function(t){var e;if(null!==(e=t.data)&&void 0!==e&&e.fb_events){var o=t.data.fb_events.map((function(t){return{event_id:t.id,event_name:t.name}}));window.fireFacebookConversionEvent(o)}})).catch((function(t){}))}}}})();